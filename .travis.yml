language: java

jdk:
  - oraclejdk8
  #- openjdk9
  # https://github.com/travis-ci/travis-ci/issues/8975
  #- oraclejdk9

branches:
  only:
    - master

before_install:
  - sudo add-apt-repository ppa:jonathonf/python-3.6 -y
  - sudo apt-get update -y
  - sudo apt-get install python3.6 libpython3.6 -y

script:
  - gradle test
  - python3.6 --version
  - pyenv versions
  - pyenv global 3.6
  - pip install --user markdown
  - pip install --user BeautifulSoup4
  - python3.6 build/create_problems_list.py
  - python3.6 build/run_unit_tests.py

#https://caveofcode.com/2017/05/publish-an-angular-app-to-github-pages/
deploy:
  provider: pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  keep-history: true
  local-dir: website
  on:
    branch: master
  target-branch: gh-pages